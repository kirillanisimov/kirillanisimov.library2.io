(()=>{"use strict";const t=[{id:"1",title:"Mock Turtle: 'why.",author:"Madelyn Mertz",description:"Alice: 'I don't know of any use, now,' thought poor Alice...",genre:"Fantasy"}],e=document.querySelector(".content"),s=document.querySelector(".add"),o=document.querySelector(".modal"),i=o.querySelector(".close"),n=o.querySelector("form");new class{constructor(){this.books=[],this.currentEditId=null,this.init()}init(){this.loadBooks(),this.setupEventListeners(),this.displayBooks()}loadBooks(){const e=localStorage.getItem("books");this.books=e?JSON.parse(e):[...t],e||localStorage.setItem("books",JSON.stringify(this.books))}saveBooks(){localStorage.setItem("books",JSON.stringify(this.books))}setupEventListeners(){s.addEventListener("click",()=>{this.currentEditId=null,o.style.display="flex",n.reset()}),i.addEventListener("click",()=>{o.style.display="none"}),n.addEventListener("submit",t=>{t.preventDefault(),this.handleFormSubmit()})}handleFormSubmit(){const t=new FormData(n),e=t.get("title"),s=t.get("author"),i=t.get("genre"),r=t.get("description");if(e&&s&&r){if(this.currentEditId){const t=this.books.find(t=>t.id===this.currentEditId);t&&(t.title=e,t.author=s,t.genre=i,t.description=r)}else{const t={id:Date.now().toString(),title:e,author:s,genre:i,description:r};this.books.push(t)}this.saveBooks(),this.displayBooks(),o.style.display="none"}else alert("Пожалуйста, заполните все поля")}displayBooks(){e&&(e.innerHTML=this.books.map(t=>`\n      <div class="card" data-id="${t.id}">\n        <h3>${t.title}</h3>\n        <h4>${t.author}</h4>\n        <p>${t.description.length>50?t.description.substring(0,50)+"...":t.description}</p>\n        <small data-genre="${t.genre}">${t.genre}</small>\n        <div>\n          <button class="edit" data-id="${t.id}">Редактировать</button>\n          <button class="delete" data-id="${t.id}">Удалить</button>\n        </div>\n      </div>\n    `).join(""),this.setupCardButtons())}setupCardButtons(){document.querySelectorAll(".delete").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget.dataset.id;e&&(this.books=this.books.filter(t=>t.id!==e),this.saveBooks(),this.displayBooks())})}),document.querySelectorAll(".edit").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget.dataset.id,s=this.books.find(t=>t.id===e);s&&(this.currentEditId=e||null,n.elements.namedItem("title").value=s.title,n.elements.namedItem("author").value=s.author,n.elements.namedItem("genre").value=s.genre,n.elements.namedItem("description").value=s.description,o.style.display="flex")})})}}})();